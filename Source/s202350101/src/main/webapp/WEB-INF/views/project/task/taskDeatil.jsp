<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %><%@ page language="java" contentType="text/html; charset=UTF-8"         pageEncoding="UTF-8"%><%@ include file="/WEB-INF/views/header_main.jsp"%><!DOCTYPE html><html><head>    <meta charset="UTF-8">    <title>Task List</title>    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>    <style>        .attached_img{            width: 150px;            height: 150px;            padding: 1%;            border: 1px solid black;}    </style><script type="text/javascript">    function delete_task(user_id,task_id,project_id){        var userInput =  prompt("삭제라혀면 ID 를입력하세요 ");        if(userInput === user_id){            $.ajax({                url         :'/task_garbage',                type        :'post',                data        :{"task_id":task_id,                            'project_id':project_id},                dataType    :"text",                success     :function (data){                    if(data === '1'){                        alert("삭제성공");                        window.location.href ="/dashboard";                    } else{// UPDATE를 수행햇지만 결과가 0이나올떄                        alert("삭제 에러 ");                    }                    return;                }            });        } else {            alert("작성자만 삭제 할 수 있습니다. 아이디를 확인하세요");            return;        }    }    function update_task(user_id,task_id,project_id){        var userInput =  prompt("수정하려면 ID 를 입력하세요 ");        if(userInput === user_id) {            var newUrl = "/task_update_form?projectId=" + project_id + "&taskId=" + task_id;            window.location.href = newUrl;        } else {            alert("작성자만 수정 할 수 있습니다. 아이디를 확인하세요 ");            return;        }    }    $(function() {        $.ajax({            url			: '/main_header',            dataType 	: 'html',            success		: function(data) {                console.log("ddd");                $('#header').html(data);            }        });        $.ajax({            url			: '/main_menu',            dataType 	: 'html',            success		: function(data) {                $('#menubar').html(data);            }        });        $.ajax({            url			: '/main_footer',            dataType 	: 'html',            success		: function(data) {                $('#footer').html(data);            }        });    });</script></head><body><div id="header"></div><div class="container-fluid">    <div class="row">        <!-- 메뉴 -->        <div id="menubar" class="menubar border-right col-md-3 col-lg-2 p-0 bg-body-tertiary">            <!-- 여기에 메뉴 내용 추가 -->        </div>        <!-- 본문 -->        <main id="center" class="col-md-9 ms-sm-auto col-lg-10 px-md-4">            <h2 style="margin: 4%">작업 상세 내역</h2>            <div class="border border-dark p-4">                <table class="table border-dark">                    <tbody>                        <tr>                            <th class="fw-bold border-dark">작업 담당자</th>                            <td class="border-dark">${task.user_name}</td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 제목</th>                            <td class="border-dark">${task.task_subject}</td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">프로젝트 단계</th>                            <td class="border-dark">${task.project_step_seq}:${task.project_s_name}</td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 내용</th>                            <td class="border-dark"> <pre>${task.task_content}</pre></td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 시작일</th>                            <td class="border-dark">${task.task_start_time}</td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 마감일</th>                            <td class="border-dark">${task.task_end_time}</td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 우선순위</th>                            <td class="border-dark">                                <c:choose>                                    <c:when test="${task.task_priority eq 0}">낮음</c:when>                                    <c:when test="${task.task_priority eq 1}">보통</c:when>                                    <c:when test="${task.task_priority eq 2}">높음</c:when>                                </c:choose>                            </td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">작업 진행 상태</th>                            <td class="border-dark">                                <c:choose>                                    <c:when test="${task.task_status eq 0}">예정된 작업</c:when>                                    <c:when test="${task.task_status eq 1}">진행중인 작업</c:when>                                    <c:when test="${task.task_status eq 2}">완료된 작업</c:when>                                </c:choose>                            </td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">공동 작업자</th>                            <td class="border-dark">                                <c:choose>                                    <c:when test="${not empty taskSubList}">                                        <c:forEach items="${taskSubList}" var="taskSub" varStatus="seq">                                            ${taskSub.user_name}<br>                                        </c:forEach>                                    </c:when>                                    <c:otherwise>                                        공동 작업자 없음                                    </c:otherwise>                                </c:choose>                            </td>                        </tr>                        <tr>                            <th class="fw-bold border-dark">첨부파일</th>                            <td class="border-dark">                                <c:choose>                                    <c:when test="${not empty taskAttachList}">                                        <div style="display: flex; padding: 2%" >                                            <c:forEach items="${taskAttachList}" var="taskAttach">                                                    <a href="${taskAttach.attach_path}/${taskAttach.attach_name}" target="_blank">보기</a><br>                                                    <img  class="attached_img" alt ="이미지 없음" src="${taskAttach.attach_path}/${taskAttach.attach_name}" alt="Attached Image">                                            </c:forEach>                                        </div>                                    </c:when>                                    <c:otherwise>                                        첨부파일 없음                                    </c:otherwise>                                </c:choose>                            </td>                        </tr>                    </tbody>                </table>                <div class="btn-group" style="margin:2%">                    <a type="button" class="btn btn-primary" onclick="delete_task('${task.user_id}',${task.task_id},${task.project_id})">삭제하기</a>                    <a type="button" class="btn btn-primary" onclick="update_task('${task.user_id}',${task.task_id},${task.project_id})">수정하기</a>                    <a type="button" class="btn btn-primary" href="task_list">목록</a>                </div>            </div>        </main>    </div></div>    <div id="footer"></div></body></html>