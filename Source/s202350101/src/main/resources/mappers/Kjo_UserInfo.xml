<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- com.oracle.s202350101.뒤에 매핑하고 싶은 모델쓰면 됩니다 
	 mapper 여러개 쓰셔도 됩니다. -->


<mapper namespace="com.oracle.s202350101.UserInfoMapper">
    <!-- UserInfo -->

    <select id="findAllUser" resultType="UserInfo">
        select *
        from user_info
    </select>
    <select id="findbyClassUser" parameterType="int" resultType="UserInfo">
        select *
        from user_info
        where class_id = #{cl_id}
          and user_auth != 'admin'
    </select>

    <select id="findbyClassUserProject" parameterType="int" resultType="UserInfo">
        select *
        from user_info u
                 left join prj_info p
                           on u.project_id = p.project_id
        where class_id = #{cl_id}
          and user_auth != 'admin'

    </select>

    <update id="auth_modify_manager" parameterType="java.util.List">
        UPDATE USER_INFO
        SET user_auth = 'manager'
        where user_id in
        <foreach collection="list" item="item" open="(" separator="," close=")">
            '${item}'
        </foreach>
    </update>

    <update id="auth_modify_student" parameterType="java.util.List">
        UPDATE USER_INFO
        SET user_auth = 'student'
        where user_id in
        <foreach collection="list" item="item" open="(" separator="," close=")">
            '${item}'
        </foreach>
    </update>

    <select id="pageUserInfo" parameterType="UserInfo" resultType="UserInfo">

        select u.*, p.project_name
        from (select rownum rn, a.*
              from (select * from USER_INFO order by USER_ID) a) u
                 left join prj_info p
                           on u.project_id = p.project_id
        where rn between #{start} and #{end}
    </select>

</mapper>

